# SPDX-FileCopyrightText: 2025 Theresa Pollinger
#
# SPDX-License-Identifier: CC-BY-4.0

# This workflow will install Python dependencies, run tests and lint with a variety of Python versions
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python

name: Python Test Tutorial and Tutorial-to-README

on:
  pull_request:
    branches: ["main"]
  workflow_dispatch:
permissions:
  contents: write

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        python-version: ["3.10", "3.14"]
    steps:
      - uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065
        with:
          python-version: ${{ matrix.python-version }}
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          python -m pip install pytest
          pip install -e .[drawing,matplotlib]
      - name: Test with pytest
        run: |
          pytest dyada_tutorial.py
          test_error_code=$?
          if [ "$test_error_code" -ne 5 ]; then
            # no tests ran
            echo "wrong pytest return code $test_error_code"
          else
            echo "pytest returned expected code 5"
            exit 0
          fi
